\section{Theory} \label{section: theor}
In all the cases below we will take the initial density $\rho_0$ to be of the form of a Gaussian wave packet:
\begin{gather}
    \rho_0(\vect{x}) = \frac{1}{\sqrt{2\pi\sigma_0^2}}\exp\left[-\frac{(\vect{x}-\vect{x_0})^2}{2\sigma_0^2}\right],
\end{gather}
where $\sigma_0$ is the initial uncertainty, and $\vect{x_0}$ is the center of the distribution.

\subsection{Quantum transport of a free particle (2D)}
\subsubsection{Analytical solution}
The solution to the Schr√∂dinger wave equation for a free particle \cite{Griffiths_2005} is given by:
\begin{gather}
    \psi(\vect{x}, t) = \frac{1}{\sqrt{2\pi\sigma_t^2}}\exp\left[-\frac{\vect{x}^2}{4\sigma_t^2}\right]\exp\left[-i \frac{m \vect{x}^2 t}{2\hbar \sigma_t}\right],
\end{gather}
where $\sigma_t = \sigma_0\sqrt{1 + i\hbar t/m\sigma_0^2}$ is the time-dependent uncertainty, $m$ is the mass of the particle, and $\hbar$ is the reduced Planck constant. For simplicity, we will take $m=1$.
Then, the probability density can be calculated as:
\begin{gather}
    \rho(\vect{x}, t) = |\psi(\vect{x}, t)|^2 = \frac{1}{2\pi\sigma_t^2}\exp\left[-\frac{\vect{x}^2}{2\sigma_t^2}\right] \label{eq: a anal}
\end{gather}

\subsubsection{Moment model}
The general form of the Wigner equation \cite{base} is given by:
\begin{gather}
    \frac{\partial W}{\partial t} + \vect{p} \cdot \nabla_x W + \Theta[V]W = \frac{\partial W}{\partial t}\Bigr |_{\text{Scat}}
\end{gather}
where $W(t, \vect{x}, \vect{p})$ is the quasi-probability density Wigner function, and $\Theta[V]W$ is the Wigner potential term. In the case of a free particle, the potential $V$, and the scattering term are zero. The equation above thus simplifies to:
\begin{gather}
    \frac{\partial W}{\partial t} + \vect{p} \cdot \nabla_x W = 0 \label{eq: wigner_free}
\end{gather}
The moments $f_\alpha$ of the Wigner function are defined as:
\begin{gather}
    f_\alpha = \int \left(\vect{p}-\vect{u}\right)^\alpha W d\vect{p}
\end{gather}
Following the steps of a Grad-type moment expansion \cite{base}, we can arrive at the Hermite-expanded Wigner function:
\begin{gather*}
    \frac{\partial f_{\alpha}}{\partial t} + \sum_{d=1}^{2} \left( \frac{\partial u_d}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_d}{\partial x_j} \right) f_{\alpha - e_d} \\
    + \sum_{j,d=1}^{2} \frac{\partial u_d}{\partial x_j} \left( T f_{\alpha - e_d - e_j} + (\alpha_j + 1) f_{\alpha - e_d + e_j} \right) \\
    + \sum_{j=1}^{2} \left( T \frac{\partial f_{\alpha - e_j}}{\partial x_j} + u_j \frac{\partial f_{\alpha}}{\partial x_j} + (\alpha_j + 1) \frac{\partial f_{\alpha + e_j}}{\partial x_j} \right)
    = 0, \numberthis \label{eq: moment_wigner}
\end{gather*}
where $e_j$ is the $j$th unit vector, $T$ is the kinetic energy, and $\vect{u}$ is the velocity. Note, that during the derivation of eq. (\ref{eq: moment_wigner}) all the terms containing a temperature gradient were eliminated as temperature can be considered constant in the case of a free particle. 

\begin{itemize}
    \item \textbf{0th moment}: \\
    The 0th moment $f_0$ is the density $\rho$. We use eq. (\ref{eq: moment_wigner}) to derive the continuity equation, we set $\alpha = (0, 0)$:
    \begin{gather}
        \frac{\partial f_{0}}{\partial t} + \sum_{j=1}^{2} \left( T \frac{\partial f_{-e_j}}{\partial x_j} + u_j \frac{\partial f_{0}}{\partial x_j} + (\alpha_j + 1) \frac{\partial f_{e_j}}{\partial x_j} \right) = 0
    \end{gather}
    Since $f_{-e_j}$ is not defined (negative indices), we simply assume $f_{-e_j} = 0$. $(\alpha_j + 1)$ becomes $1$, and the equation above becomes:
    \begin{gather}
        \frac{\partial f_{0}}{\partial t} + \sum_{j=1}^{2} \left( u_j \frac{\partial f_{0}}{\partial x_j} + \frac{\partial f_{e_j}}{\partial x_j} \right) = 0 \label{eq: a1}
    \end{gather}

    \item \textbf{1st moment}: \\
    The 1st moment $f_{e_d}$ is the momentum density. Same as before, we use eq. (\ref{eq: moment_wigner}) to derive the momentum equation, we set $\alpha = e_d$:
    \begin{gather}
        \frac{\partial f_{e_d}}{\partial t} + \sum_{d'=1}^{2} \left( \frac{\partial u_{d'}}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_{d'}}{\partial x_j} \right) f_{e_d - e_{d'}} + \sum_{j=1}^{2} \left( T \frac{\partial f_{0}}{\partial x_j} + u_j \frac{\partial f_{e_d}}{\partial x_j} + (\alpha_j + 1) \frac{\partial f_{2 e_d}}{\partial x_j} \delta_{j d} \right) = 0
    \end{gather}
    When $d' = d$, $f_{e_d - e_{d'}} = f_{0}$. When $d' \neq d$, $d'<d$ since $d=1$ and $d'\in[1,2]$, thus $f_{e_d - e_{d'}} = 0$. Also, $\alpha_j + 1 = 2$ when \( j = d \), otherwise $\alpha_j + 1 = 1$.
    Applying this yields:
    \begin{gather}        
        \frac{\partial f_{e_d}}{\partial t} + \left( \frac{\partial u_d}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_d}{\partial x_j} \right) f_{0} + \sum_{j=1}^{2} \left( T \frac{\partial f_{0}}{\partial x_j} + u_j \frac{\partial f_{e_d}}{\partial x_j} + 2 \delta_{j d} \frac{\partial f_{2 e_d}}{\partial x_j} \right) = 0 \label{eq: a2}
    \end{gather}

    \item \textbf{2nd moment}: \\
    The 2nd moment $f_{2 e_d}$ is the energy density. Again, we use eq. (\ref{eq: moment_wigner}) to derive the corresponding equation, we set $\alpha = 2 e_d$:
    \begin{gather}
        \frac{\partial f_{2 e_d}}{\partial t} + \left( \frac{\partial u_d}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_d}{\partial x_j} \right) f_{e_d} + \sum_{j=1}^{2} \left( T \frac{\partial f_{e_d - e_j}}{\partial x_j} + u_j \frac{\partial f_{2 e_d}}{\partial x_j} + 3 \delta_{j d} \frac{\partial f_{3 e_d}}{\partial x_j} \right) = 0
    \end{gather}
    Again, when $j = d$, $f_{e_d - e_j} = f_{0}$, otherwise $f_{e_d - e_j}=0$. The term $\alpha_j + 1 = 3$ when $j = d$, otherwise $\alpha_j + 1 = 1$. Thus:
    \begin{gather}
        \frac{\partial f_{2 e_d}}{\partial t} + \left( \frac{\partial u_d}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_d}{\partial x_j} \right) f_{e_d} + T \frac{\partial f_{0}}{\partial x_d} + u_d \frac{\partial f_{2 e_d}}{\partial x_d} + 3 \frac{\partial f_{3 e_d}}{\partial x_d} = 0
    \end{gather}
    For closure of the moment equations, we need to express higher-order moments in terms of the known moments. We choose the maximum entropy closure, as in the case of a free particle the function that maximizes the entropy is simply a Gaussian function. Thus, the 3rd moment $f_{3 e_d}=0$ since the third (central) moment of a Gaussian is zero. Substituting this into the equation above yields the final form of the 2nd moment equation:
    \begin{gather}
        \frac{\partial f_{2 e_d}}{\partial t} + \left( \frac{\partial u_d}{\partial t} + \sum_{j=1}^{2} u_j \frac{\partial u_d}{\partial x_j} \right) f_{e_d} + T \frac{\partial f_{0}}{\partial x_d} + u_d \frac{\partial f_{2 e_d}}{\partial x_d} = 0\label{eq: a3}
    \end{gather}
\end{itemize}

\subsection{Quantum transport of a particle over a finite square potential barrier (1D)}
In this section we will look at the transport of particle travelling over a finite square potential barrier defined by the following function:
\begin{gather}
    V(x) = \begin{cases}
        V_0, & \text{if } |x| < a \\
        0, & \text{otherwise}
    \end{cases} \label{eq: V}
\end{gather}

\subsubsection{(Semi)Analytical solution}
Since the (semi)analytical solution to this problem is tedious to derive, we will not present the derivation. Instead, the solution is given by:
\begin{gather}
    \psi(x, t) = \int_{-\infty}^{\infty} A(k) \left[ 
    \begin{cases}
    e^{ikx} + R(k) e^{-ikx} & \text{for } x < 0 \\
    C(k) e^{\kappa x} + D(k) e^{-\kappa x} & \text{for } 0 \leq x \leq a \\
    T(k) e^{ikx} & \text{for } x > a
    \end{cases}
    \right] e^{-iE(k)t/\hbar} dk, \label{eq: b anal}
\end{gather}
where $A(k)$ is the amplitude of the wave, $R(k)$ is the reflection coefficient, $C(k)$ and $D(k)$ are the coefficients of the wave inside the barrier, $T(k)$ is the transmission coefficient, $k$ is the wave number, $\kappa$ is the decay constant, and $E(k)$ is the energy of the particle \cite{Griffiths_2005}.
For a Gaussian wave packet, the initial amplitude in momentum space is also Gaussian:
\begin{gather}
    A(k) = \left( \frac{\sigma_x}{\sqrt{\pi}} \right)^{1/2} e^{-\frac{\sigma_x^2 (k - k_0)^2}{2}} e^{-ikx_0},
\end{gather}
where $k_0 = \frac{p_0}{\hbar}$ is the central wave number of the packet.

\subsubsection{Moment model}
In this case, we will start from the equations of the "regularized moment system truncated up to M = 3" \cite{base}:
\begin{gather}
   \frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} + \rho \frac{\partial u}{\partial x} = 0 \label{eq: moment_barrier first} \\
   \rho \frac{\partial u}{\partial t} + \rho u \frac{\partial u}{\partial x} + \frac{\partial P}{\partial x} = - \frac{\partial V}{\partial x} \rho \\
   \frac{\partial (P/2)}{\partial t} + u \frac{\partial (P/2)}{\partial x} + \frac{3}{2} P \frac{\partial u}{\partial x} + 3 \frac{\partial f_3}{\partial x} = 0 \\
   \frac{\partial f_3}{\partial t} - \frac{P}{2} \frac{\partial \rho}{\partial x} \frac{1}{\rho^2} + \frac{P}{2 \rho} \frac{\partial P}{\partial x} + u \frac{\partial f_3}{\partial x} = - \frac{1}{\tau} f_3 + \frac{\hbar^2}{24} \frac{\partial^3 V}{\partial x^3} \rho \label{eq: moment_barrier last}
\end{gather}
Since eqs. (\ref{eq: moment_barrier first}) - (\ref{eq: moment_barrier last}) turned out to be very difficult to simulate due to numerical instabilities, we perform an asymptotic expansion of the moments around $t = 0$ up to $O(t^2)$:
\begin{gather}
        \rho(x, t) = \rho_0(x) + \rho_1(x) t + \rho_2(x) t^2 + O(t^3) \label{eq: moment_expansion first} \\
    u(x, t) = u_0(x) + u_1(x) t + u_2(x) t^2 + O(t^3) \\
    P(x, t) = P_0(x) + P_1(x) t + P_2(x) t^2 + O(t^3) \\
    f_3(x, t) = f_{3,0}(x) + f_{3,1}(x) t + f_{3,2}(x) t^2 + O(t^3) \label{eq: moment_expansion last}
\end{gather}
Plugging in eqs. (\ref{eq: moment_expansion first}) - (\ref{eq: moment_expansion last}) into eqs. (\ref{eq: moment_barrier first}) - (\ref{eq: moment_barrier last}), collecting terms of the same order of $t$, and subsequently solving the resulting system of equations, we arrive at the following:
\begin{gather}
     \rho(x, t) \approx \rho_0(x) - p_0 \frac{\partial \rho_0}{\partial x} t + \left( - p_0 \frac{\partial V}{\partial x} \frac{\partial \rho_0}{\partial x} + p_0^2 \frac{\partial^2 \rho_0}{\partial x^2} - \rho_0 p_0 \frac{\partial^2 V}{\partial x^2} \right) t^2 \label{eq: rho_expansion}
    %  u(x, t) \approx p_0 - \frac{\partial V}{\partial x} t + p_0 \frac{\partial^2 V}{\partial x^2} t^2, \\
    %  P(x, t) \approx P_0(x) + \left( 3 \sigma_p^2 \frac{\partial^2 V}{\partial x^2} - \frac{\hbar^2}{4} \frac{\partial^4 V}{\partial x^4} \rho_0 \right) t^2, \\
    %  f_3(x, t) \approx \frac{\hbar^2}{24} \frac{\partial^3 V}{\partial x^3} \rho_0 t + f_{3,2}(x) t^2.
\end{gather}
Since the main interest is in the density, the results for the other moments are omitted for brevity.
% Since to resolve $f_{3,2}$ we would need to consider higher-order moments, we simply assume $f_{3,2} = 0$.
